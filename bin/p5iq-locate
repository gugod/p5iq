#!/usr/bin/env perl
use v5.18;
use warnings;

use FindBin;
use lib "${FindBin::Bin}/../local/lib/perl5";
use lib "${FindBin::Bin}/../lib";

use P5iq::Search;

use Getopt::Long;

GetOptions(
    "s|size=i" => \(my $size = 10),
    "symbol" => \(my $symbol),
    "sub-named" => \(my $sub_named),
    "hash-keys" => \(my $hash_keys),
    "hash-name" => \(my $hash_name),
    "var-def" => \(my $var_def),
    "arglist" => \(my $arglist),
    "fun-call" => \(my $fun_call),
    "whohas" => \(my $whohas),
);

my $query_string = shift // die "No query string...";
if( $hash_keys ){
    P5iq::Search::locate_hash_keys($query_string, $size);
}
elsif( $hash_name ){
    P5iq::Search::locate_hash_name($query_string, $size);
}
elsif( $var_def ){
    P5iq::Search::locate_var_def($query_string, $size);
}
elsif ($arglist) {
    P5iq::Search::locate_arglist($query_string, $size);
}
elsif ($fun_call) {
    P5iq::Search::locate_function_calls($query_string, $size);
}
elsif ($whohas) {
    P5iq::Search::locate_method_calls($query_string, $size);
}
else{
    P5iq::Search::locate_symbols($query_string, $size, $symbol, $sub_named, $hash_keys);
}

